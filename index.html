<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>G4S - Инкассаторская служба</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="container">
        <nav>
            <h2>G4S</h2>
            <ul>
                <li><a href="index.html">Главная</a></li>
                <li><a href="about.html">О компании</a></li>
                <li><a href="services.html">Услуги</a></li>
                <li><a href="contact.html">Контакты</a></li>
            </ul>
        </nav>
    </div>
</header>

<section class="hero">
    <h1>Надежная доставка ценностей по всему миру</h1>
</section>

<section class="section">
    <div class="container">
        <h2>Международная доставка</h2>
        <p style="text-align:center;">
            G4S предоставляет услуги инкассации и безопасной доставки по всему миру. 
            Мы гарантируем максимальную защиту, конфиденциальность и точность выполнения задач.
        </p>
    </div>
</section>

<footer>
    <p>© 2026 G4S. Все права защищены.</p>
</footer>
<div id="chatBox" style="position:fixed;bottom:20px;right:20px;width:300px;background:#fff;border:1px solid #ccc;padding:10px;z-index:9999;">
    <h4>Поддержка</h4>
    <div id="chat" style="height:150px;overflow:auto;border:1px solid #ddd;margin-bottom:5px;padding:5px;"></div>
    <input id="msg" placeholder="Введите сообщение" style="width:70%;">
    <button onclick="sendMessage()">➤</button>
</div>

<script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

<script>
const socket = io("https://g4s-chat-server.onrender.com");

socket.on("loadMessages", (messages) => {
    document.getElementById("chat").innerHTML = "";
    messages.forEach(renderMessage);
});

socket.on("newMessage", (msg) => {
    renderMessage(msg);
});

socket.on("updateMessage", (msg) => {
    const div = document.getElementById(msg.id);
    if (div) {
        div.innerHTML = formatMessage(msg);
    }
});

function sendMessage() {
    const text = document.getElementById("msg").value;
    if (!text) return;

    socket.emit("sendMessage", {
        text: text,
        sender: "client"
    });

    document.getElementById("msg").value = "";
}

function editMessage(id) {
    const newText = prompt("Изменить сообщение:");
    if (!newText) return;

    socket.emit("editMessage", {
        id: id,
        text: newText,
        sender: "client"
    });
}

function renderMessage(msg) {
    const div = document.createElement("div");
    div.id = msg.id;
    div.innerHTML = formatMessage(msg);
    document.getElementById("chat").appendChild(div);
}

function formatMessage(msg) {
    return `
        <b>${msg.sender}:</b> ${msg.text}
        ${msg.edited && msg.sender === "client" ? " (изменено)" : ""}
        ${msg.sender === "client" ? `<button onclick="editMessage(${msg.id})">✏</button>` : ""}
    `;
}
</script>
</body>

</html>
